<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Diffie Hellman</title>
</head>
<style>
    h1{
        text-align: center;
    }
    h2{
        text-align: center;
    }
    code{
        display: block;
        background-color: #c9c9c9;
    }
    .comment{
        color: blue;
    }
    .code{
        color: red;
    }
</style>
<body>
    <h1>Diffie Hellman Key Exchange Example</h1>
    <div>
        <h2><a href="diffie.py">download</a> python3 example</h2>
    <code>
        <p class="comment"># Agree on 2 prime numbers for generator and prime modulas</p>
        <p class="code">print("Please agree on 2 prime numbers that will be publicly shared to generate a key!")</p>

        <p class="code">print("Please enter a prime number for the generator:", end="")</p>
        <p class="code">primeGen = int(input())</p>

        <p class="code">print("Please enter a prime number for the modulator:", end="")</p>
        <p class="code">primeMod = int(input())</p>

        <p class="comment">#User ones number</p>
        <p class="code">print("Please enter a number as your key:", end="")</p>
        <p class="code">userOnePrivateKey = int(input())</p>

        <p class="comment">#generate a publicly shared number to send to user two</p>
        <p class="code">userOneShared = primeGen**userOnePrivateKey%primeMod</p>

        <p class="code">print("user one's shard key is", userOneShared)</p>

        <p class="comment">#User two's number</p>
        <p class="code">print("Please enter a number as your key:", end="")</p>
        <p class="code">userTwoPrivateKey = int(input())</p>

        <p class="comment">#generate a publicly shared number to send to user one</p>
        <p class="code">userTwoShared = primeGen**userTwoPrivateKey%primeMod</p>

        <p class="code">print("user two's shard key is", userTwoShared)</p>

        <p class="comment"># Once both users have shared the public keys we can generate a key using the results</p>
        <p class="comment"># the key is generated by using the other uses shared key to the power of the first</p>
        <p class="comment"># current uses private key mod the prime mod we agreed on at the start</p>
        <p class="code">userOneFinalKey = userTwoShared**userOnePrivateKey%primeMod</p>

        <p class="code">userTwoFinalKey = userOneShared**userTwoPrivateKey%primeMod</p>

        <p class="code">if userOneFinalKey == userTwoFinalKey:</p>
        <p class="code">&nbsp&nbsp&nbsp&nbsp print("Both users have the key:", userOneFinalKey)</p>
        <p class="code">else:</p>
        <p class="code">&nbsp&nbsp&nbsp&nbsp print("user one has the key:", userOneFinalKey, "and user two has the key", userTwoFinalKey)</p>
    </code>


    </div>
</body>
</html>